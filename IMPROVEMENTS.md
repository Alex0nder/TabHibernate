# Что ещё можно улучшить

Приоритеты: быстрые победы → средние задачи → на будущее.

---

## Быстрые победы (мало кода, заметная польза)

| Что | Зачем |
|-----|--------|
| **Лимит бэкапов по датам** | В DEVELOPMENT.md уже есть: хранить только последние N дней (например 30) для ключей `backup_YYYY-MM-DD`. Иначе storage со временем раздувается. Добавить очистку в `onAlarmCheck` или при новом бэкапе. |
| **Бейдж на иконке** | Показывать число приостановленных сегодня на иконке расширения (`chrome.action.setBadgeText`). Пользователь видит активность без открытия popup. |
| **Единая константа CLOSED_SAVED_MAX** | Сейчас дублируется в service_worker.js и history.js. Один источник истины (например только в SW, history при открытии запрашивает лимит через сообщение или хранит копию в одном месте). |
| **Подсказка в popup про таймаут** | В popup.html текст «5–15 min» устарел — таймаут настраивается (5/10/15/…/60). Обновить текст в блоке About. |

---

## Средние задачи (UX и стабильность)

| Что | Зачем |
|-----|--------|
| **Интервал проверки** | Сейчас будильник раз в 1 мин. Добавить в настройки выбор: 1 / 2 / 5 мин (с подсказкой про батарею). Меньше срабатываний — меньше нагрузка. |
| **Whitelist доменов** | Настройка «не приостанавливать сайты» (например mail.google.com, web.telegram.org). Список доменов в settings, проверка в `isTabEligibleForSuspend` или перед suspend. |
| **Очистка старых suspended_*** | Ключи `suspended_<tabId>` удаляются при закрытии вкладки и при restore. Если вкладку закрыли без restore (краш и т.п.), ключ остаётся. Раз в N дней или при старте можно проходить по ключам и удалять те, для которых вкладки уже нет. |
| **Экспорт/импорт настроек** | В DEVELOPMENT.md: сохранять settings в JSON и восстанавливать. Удобно при переустановке или втором профиле. |

---

## На будущее (опционально)

| Что | Зачем |
|-----|--------|
| **Режим «приостанавливать в инкогнито»** | Сейчас инкогнито не суспендим. Опция в настройках для тех, кто хочет экономить память и там. |
| **Версионирование storage** | Ключ `storageVersion` и миграция при обновлении расширения (переименование ключей, сброс устаревших). Полезно при смене формата данных. |
| **Favicon без внешнего запроса** | При suspend один раз запросить иконку и сохранить как Data URL в `suspended_<tabId>`. Заглушка не обращается к Google, работает офлайн и без утечки домена. |
| **Первый запуск** | Одноразовое уведомление или подсказка в popup («Расширение приостанавливает неактивные вкладки через N мин» с «Больше не показывать»). |

---

## Уже в порядке

- Восстановление состояния при пробуждении SW, троттл записи, prune, fallback URL на заглушке.
- Обработка ошибок в onMessage и onAlarmCheck.
- Placeholder с title и favicon, restore по клику по фону.
- Проверка таба перед discard/update, валидация настроек и lastActivityByTab.

Можно брать пункты из «Быстрых побед» по одному — они дают максимум пользы при минимуме кода.
